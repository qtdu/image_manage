<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Drive Image Gallery</title>
<style>
  body { font-family: Arial; padding: 20px }
  img {
    max-width: 200px;
    max-height: 200px;
    margin: 8px;
    border: 1px solid #ccc;
    object-fit: contain;
  }
  #gallery { display: flex; flex-wrap: wrap }
</style>
</head>
<body>

<h2>Upload hình</h2>
<input type="file" id="fileInput" accept="image/*">
<button onclick="uploadImage()">Upload</button>

<hr>
<h3>Gallery</h3>
<div id="gallery"></div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbyXxEzdwMNRoxj18ZbDDdq22cDKQ41hptuLiiqgIhjQipRBnSnrWLvJNOeIVv5CQs0/exec";

function uploadImage() {
  const file = fileInput.files[0];
  if (!file) return alert("Chưa chọn hình");

  const reader = new FileReader();
  reader.onload = async () => {
    const base64 = reader.result.split(",")[1];

    const res = await fetch(API_URL, {
      method: "POST",
      body: JSON.stringify({
        name: file.name,
        type: file.type,
        base64
      })
    });

    const json = await res.json();
    if (json.success) loadImages();
    else alert("Upload lỗi");
  };
  reader.readAsDataURL(file);
}

async function loadImages() {
  const res = await fetch(API_URL);
  const links = await res.json();

  gallery.innerHTML = "";
  links.forEach(link => {
    const img = document.createElement("img");
    img.src = link;
    gallery.appendChild(img);
  });
}

loadImages();
</script>
</body>
</html>
